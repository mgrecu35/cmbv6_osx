using PyCall
os=pyimport("os")
sys=pyimport("sys")
glob=pyimport("glob")
sys["path"]["append"]("/Users/mgrecu/ORO/cmbv6x")
include("src_jl/structDef.jl")
include("src_jl/scatTables.jl")
include("src_jl/readInputDPR.jl")
include("src_jl/readInput.jl")
include("src_jl/radarMod.jl")
include("src_jl/psdInt_2.jl")
readOrb=pyimport("readOrb")
fs=glob.glob("DPR-CS/*HDF5")
fs2=glob.glob("CMB/*HDF5")
fnameT="tables_nsv_rho085_2_dmTs11.nc"

#parse(Int,get(fs,0)[40:47])


fBigL=[
"DPR-CS/2A-CS-CONUS.GPM.DPR.V8-20180723.20140403-S231912-E232750.000549.V06A.HDF5"
 "DPR-CS/2A-CS-CONUS.GPM.DPR.V8-20180723.20140407-S212633-E213451.000610.V06A.HDF5"
 "DPR-CS/2A-CS-CONUS.GPM.DPR.V8-20180723.20140420-S180115-E180954.000810.V06A.HDF5"
 "DPR-CS/2A-CS-CONUS.GPM.DPR.V8-20180723.20140429-S064709-E065546.000943.V06A.HDF5"
 "DPR-CS/2A-CS-CONUS.GPM.DPR.V8-20180723.20140502-S054457-E055335.000989.V06A.HDF5"
 "DPR-CS/2A-CS-CONUS.GPM.DPR.V8-20180723.20140510-S033048-E033926.001112.V06A.HDF5"
 "DPR-CS/2A-CS-CONUS.GPM.DPR.V8-20180723.20140516-S012710-E013540.001204.V06A.HDF5"
 "DPR-CS/2A-CS-CONUS.GPM.DPR.V8-20180723.20140528-S215907-E220745.001404.V06A.HDF5"
 "DPR-CS/2A-CS-CONUS.GPM.DPR.V8-20180723.20140531-S205722-E210600.001450.V06A.HDF5"
 "DPR-CS/2A-CS-CONUS.GPM.DPR.V8-20180723.20140602-S204711-E205549.001481.V06A.HDF5"
 "DPR-CS/2A-CS-CONUS.GPM.DPR.V8-20180723.20140603-S195546-E200412.001496.V06A.HDF5"
 "DPR-CS/2A-CS-CONUS.GPM.DPR.V8-20180723.20140608-S184323-E185201.001573.V06A.HDF5"
 "DPR-CS/2A-CS-CONUS.GPM.DPR.V8-20180723.20140608-S184323-E185201.001573.V06A.HDF5"
 "DPR-CS/2A-CS-CONUS.GPM.DPR.V8-20180723.20140611-S174100-E174934.001619.V06A.HDF5"
 "DPR-CS/2A-CS-CONUS.GPM.DPR.V8-20180723.20140628-S215912-E220749.001886.V06A.HDF5"
 "DPR-CS/2A-CS-CONUS.GPM.DPR.V8-20180723.20140629-S210739-E211530.001901.V06A.HDF5"
 "DPR-CS/2A-CS-CONUS.GPM.DPR.V8-20180723.20140706-S194349-E195226.002009.V06A.HDF5"
 "DPR-CS/2A-CS-CONUS.GPM.DPR.V8-20180723.20140714-S172828-E173706.002132.V06A.HDF5"
 "DPR-CS/2A-CS-CONUS.GPM.DPR.V8-20180723.20140715-S082911-E083749.002142.V06A.HDF5"
 "DPR-CS/2A-CS-CONUS.GPM.DPR.V8-20180723.20140715-S163651-E164517.002147.V06A.HDF5"
 "DPR-CS/2A-CS-CONUS.GPM.DPR.V8-20180723.20150403-S123341-E124220.006221.V06A.HDF5"
 "DPR-CS/2A-CS-CONUS.GPM.DPR.V8-20180723.20150415-S232034-E232850.006415.V06A.HDF5"
 "DPR-CS/2A-CS-CONUS.GPM.DPR.V8-20180723.20180416-S001234-E002112.023465.V06A.HDF5"]
plt=pyimport("matplotlib.pyplot")
xl=[[300,400],[200,400],[600,700],[350,500],[100,220],[150,250],[350,450],
[180,320],[250,320],[150,220],[500,550],[200,300],[410,510],[100,300],[1,800],[1,200],
[50,200],[1,800],[210,280],[1,800],[300,400],[200,350]]
#17 some conv
#some congestus before 13
#19 good conv tower
#20
#22 oklahome mcs
#21 nice stratiform
#7  stratiform
#8 convective (isolated)
#9
for ifile=13:13
    zku,zka,sfcPrecip,zsfc,hzero,bcf,bst,brs,bzd,bbPeak,pType,sfcType,
    reliabF,piaSRT,locZAngle=readnetcdfj(fBigL[ifile])
    for di=-1:3
    plt.figure()
    plt.subplot(211)
    plt.pcolormesh(zku[:,23+di,end:-1:1]',vmin=10,vmax=50, cmap="jet")
    plt.xlim(xl[ifile][1],xl[ifile][2])
    plt.ylim(1,100)
    plt.colorbar()
    plt.subplot(212)
    plt.pcolormesh(zka[:,11+di,end:-1:1]',vmin=10,vmax=40, cmap="jet")
    plt.xlim(xl[ifile][1],xl[ifile][2])
    plt.ylim(1,100)
    plt.colorbar()
    end
end
